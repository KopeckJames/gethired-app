import{u as E,r,a as S,j as e}from"./components-BgVkQzWd.js";import{C as U}from"./Card-FIoUA48z.js";import{B as c}from"./Button-DUVeCt1Z.js";import{I as F}from"./Input-vO5gT9lF.js";import{S as T}from"./Select-BE_f6oK7.js";import{E as k,M as y}from"./EmptyState-CjogxIWU.js";import{A as O}from"./Alert-nOZsKWD7.js";function X(){const{documents:m,error:p}=E(),[s,u]=r.useState(null),[g,x]=r.useState(!1),[h,w]=r.useState("resume"),[N,n]=r.useState(!1),[f,i]=r.useState(null),d=r.useRef(null),j=S();if(p)return e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error"}),e.jsx("p",{className:"text-gray-600",children:p})]})});const D=async t=>{var v;const a=(v=t.target.files)==null?void 0:v[0];if(!a)return;x(!0),i(null);const l=new FormData;l.append("file",a),l.append("type",h);try{const o=await fetch("/api/documents/upload",{method:"POST",body:l});if(!o.ok){const C=await o.json();throw new Error(C.error||"Failed to upload document")}d.current&&(d.current.value=""),n(!1),j.revalidate()}catch(o){i(o instanceof Error?o.message:"Failed to upload document")}finally{x(!1)}},b=async t=>{try{const a=await fetch(`/api/documents/${t}`,{method:"DELETE"});if(!a.ok){const l=await a.json();throw new Error(l.error||"Failed to delete document")}j.revalidate()}catch(a){i(a instanceof Error?a.message:"Failed to delete document")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Documents"}),e.jsx(c,{onClick:()=>n(!0),children:"Upload Document"})]}),f&&e.jsx(O,{variant:"error",onClose:()=>i(null),children:f}),m.length===0?e.jsx(k,{title:"No documents",description:"Upload your first document to get started",action:e.jsx(c,{onClick:()=>n(!0),children:"Upload Document"})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:m.map(t=>e.jsx(U,{variant:"bordered",className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:t.type}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(t.uploadedAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"secondary",onClick:()=>u(t),children:"View"}),e.jsx(c,{variant:"outline",onClick:()=>b(t.id),children:"Delete"})]})]})},t.id))}),e.jsx(y,{isOpen:N,onClose:()=>n(!1),title:"Upload Document",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(T,{label:"Document Type",value:h,onChange:t=>w(t.target.value),options:[{value:"resume",label:"Resume"},{value:"job_description",label:"Job Description"},{value:"cover_letter",label:"Cover Letter"},{value:"other",label:"Other"}]}),e.jsx(F,{ref:d,type:"file",accept:".pdf,.doc,.docx,.txt",onChange:D,disabled:g}),e.jsx("p",{className:"text-sm text-gray-500",children:"Supported formats: PDF, DOC, DOCX, TXT"})]})}),e.jsx(y,{isOpen:!!s,onClose:()=>u(null),title:(s==null?void 0:s.name)??"",children:e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:s==null?void 0:s.content})})})]})}export{X as default};
