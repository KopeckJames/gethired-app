import{r as t,c as l,b as p,j as A}from"./components-BTXmr68H.js";function c(e){return{...e,createdAt:new Date(e.createdAt)}}const d=t.createContext(null);function y({children:e,initialUser:o,initialAuthState:s}){const[a,i]=t.useState(o?c(o):null),[h,v]=t.useState(!0);l();const u=p();t.useEffect(()=>{s&&(async()=>{try{const r=await fetch("/auth/verify",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}),n=await r.json();if(!r.ok){i(null),document.cookie="auth_token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;",u("/?error="+encodeURIComponent(n.error||"Authentication failed. Please sign in again."));return}n.user&&i(c(n.user))}catch(r){console.error("Error verifying auth:",r)}})()},[s,u]);const f={isAuthenticated:!!a,user:a,isInitialized:h};return A.jsx(d.Provider,{value:f,children:e})}function j(){const e=t.useContext(d);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}export{y as A,j as u};
